<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MCreator Web Lite Modular - Versión Completa Mejorada</title>
<style>
  body { font-family: Arial, Helvetica, sans-serif; margin:0; background:#e6f2ff; color:#333; line-height:1.5; }
  header { background:#1e3a5f; color:white; padding:1.2em; text-align:center; box-shadow:0 3px 8px rgba(0,0,0,0.3); }
  main { padding:1.2em; max-width:960px; margin:0 auto; }
  nav { display:flex; flex-wrap:wrap; margin-bottom:1.2em; justify-content:center; gap:0.4em; }
  nav button { flex:1 1 110px; padding:0.8em; cursor:pointer; border:none; border-radius:8px; background:#3a6ea5; color:white; font-weight:bold; transition:0.2s; }
  nav button.active, nav button:hover { background:#1e3a5f; }
  section { display:none; background:white; padding:1.4em; border-radius:10px; box-shadow:0 3px 12px rgba(0,0,0,0.15); margin-bottom:1.2em; }
  section.active { display:block; }
  input, select, textarea, button { width:100%; margin:0.7em 0; padding:0.7em; box-sizing:border-box; border-radius:6px; border:1px solid #ccc; font-size:1em; }
  textarea { height:160px; resize:vertical; font-family: 'Courier New', monospace; }
  img.preview { max-width:160px; margin:0.7em 0; display:block; border:1px solid #aaa; border-radius:8px; box-shadow:0 2px 6px rgba(0,0,0,0.15); }
  button { background:#3a6ea5; color:white; font-weight:bold; cursor:pointer; border:none; transition:0.2s; }
  button:hover { background:#1e3a5f; }
  .warning { background:#fff3cd; color:#664d03; padding:1em; border-radius:8px; border:1px solid #ffeeba; margin:1.5em 0; }
  .subsection { background:#f8f9fa; padding:1em; border-radius:6px; margin:1em 0; }
  label { font-weight:bold; display:block; margin-top:1em; }
</style>
</head>
<body>

<header>
  <h1>MCreator Web Lite Modular - ¡Completo y Mejorado!</h1>
  <p>Crea mods para Minecraft en navegador (móvil/PC). Ahora con comandos, GUI y eventos de teclas.</p>
</header>

<main>
  <nav>
    <button class="tab-btn active" onclick="showTab('blocks')">Bloques</button>
    <button class="tab-btn" onclick="showTab('items')">Items/Espadas</button>
    <button class="tab-btn" onclick="showTab('mobs')">Mobs</button>
    <button class="tab-btn" onclick="showTab('gui')">GUI</button>
    <button class="tab-btn" onclick="showTab('commands')">Comandos</button>
    <button class="tab-btn" onclick="showTab('armor')">Armaduras</button>
    <button class="tab-btn" onclick="showTab('export')">Exportar</button>
  </nav>

  <!-- Bloques -->
  <section id="blocks" class="active">
    <h2>Crear Bloque</h2>
    <input type="text" id="blockName" placeholder="Nombre del bloque">
    <input type="color" id="blockColor" value="#ff0000">
    <input type="number" id="blockHardness" placeholder="Dureza" value="1.5" step="0.1">
    <input type="number" id="blockResistance" placeholder="Resistencia" value="10" step="0.1">
    <input type="file" id="blockTexture" accept="image/*">
    <img id="blockTexturePreview" class="preview" src="" alt="Vista previa">
    <div>
      <button onclick="generateBlock()">Generar Bloque</button>
      <button onclick="clearFile('blockTexture')">Eliminar Textura</button>
    </div>
    <textarea id="blockOutput" readonly></textarea>
  </section>

  <!-- Items / Espadas -->
  <section id="items">
    <h2>Crear Item o Espada</h2>
    <input type="text" id="itemName" placeholder="Nombre del item/espada">
    <input type="number" id="itemDamage" placeholder="Daño" value="4">
    <input type="number" id="itemStack" placeholder="Stack máximo" value="1">
    <input type="file" id="itemTexture" accept="image/*">
    <img id="itemTexturePreview" class="preview" src="" alt="Vista previa">

    <div class="subsection">
      <h3>Proyectil al usar (click derecho)</h3>
      <select id="itemProjectile">
        <option value="none">No</option>
        <option value="arrow">Flecha</option>
        <option value="fireball">Bola de fuego</option>
        <option value="snowball">Bola de nieve</option>
        <option value="custom">Modelo personalizado</option>
      </select>
      <input type="number" id="itemProjectileDamage" placeholder="Daño del proyectil" value="4" step="0.5">
    </div>

    <div class="subsection">
      <h3>Evento al presionar tecla</h3>
      <label>Tecla para activar (e.g., 'F' para vuelo)</label>
      <input type="text" id="itemKeyBind" placeholder="Tecla (e.g., F, R, espacio)">
      <select id="itemKeyEvent">
        <option value="none">Ninguno</option>
        <option value="fly">Activar vuelo</option>
        <option value="heal">Curar al jugador</option>
        <option value="teleport">Teletransportar</option>
        <option value="custom">Efecto personalizado</option>
      </select>
      <textarea id="itemKeyCustom" placeholder="Describe el efecto personalizado..."></textarea>
    </div>

    <div>
      <button onclick="generateItem()">Generar Item</button>
      <button onclick="clearFile('itemTexture')">Eliminar Textura</button>
    </div>
    <textarea id="itemOutput" readonly></textarea>
  </section>

  <!-- Mobs -->
  <section id="mobs">
    <h2>Crear Mob Avanzado</h2>
    <input type="text" id="mobName" placeholder="Nombre del mob">
    <input type="number" id="mobHealth" placeholder="Vida (corazones x2)" value="20">
    <input type="number" id="mobDamage" placeholder="Daño al atacar" value="3">
    <input type="number" id="mobSpeed" placeholder="Velocidad" value="0.3" step="0.1">

    <div class="subsection">
      <h3>Habilidades</h3>
      <label>¿Puede volar?</label>
      <select id="mobFlying">
        <option value="no">No</option>
        <option value="bee">Como abeja</option>
        <option value="ghast">Como ghast</option>
        <option value="phantom">Como phantom</option>
      </select>
      <label>Efecto al atacar</label>
      <select id="mobEffect">
        <option value="none">Ninguno</option>
        <option value="poison">Veneno</option>
        <option value="wither">Wither</option>
      </select>
      <input type="number" id="mobEffectDuration" placeholder="Duración (segundos)" value="5">
    </div>

    <input type="file" id="mobModel" accept=".json,.obj,.png">
    <img id="mobModelPreview" class="preview" src="" alt="Vista previa">
    <div>
      <button onclick="generateMob()">Generar Mob</button>
      <button onclick="clearFile('mobModel')">Eliminar Modelo</button>
    </div>
    <textarea id="mobOutput" readonly></textarea>
  </section>

  <!-- GUI -->
  <section id="gui">
    <h2>Crear GUI Personalizada</h2>
    <input type="text" id="guiName" placeholder="Nombre de la GUI (e.g., MiInventario)">
    <input type="number" id="guiSlots" placeholder="Número de slots" value="9">
    <select id="guiType">
      <option value="inventory">Inventario estándar</option>
      <option value="crafting">Mesa de crafteo</option>
      <option value="furnace">Horno</option>
      <option value="custom">Personalizado</option>
    </select>

    <div class="subsection">
      <h3>Eventos en GUI</h3>
      <label>Acción al abrir</label>
      <textarea id="guiOpenEvent" placeholder="E.g., reproducir sonido, dar efecto..."></textarea>
      <label>Acción al click en slot</label>
      <textarea id="guiClickEvent" placeholder="E.g., ejecutar comando, cambiar item..."></textarea>
    </div>

    <input type="file" id="guiImage" accept="image/*">
    <img id="guiImagePreview" class="preview" src="" alt="Vista previa">
    <div>
      <button onclick="generateGUI()">Generar GUI</button>
      <button onclick="clearFile('guiImage')">Eliminar Imagen</button>
    </div>
    <textarea id="guiOutput" readonly></textarea>
  </section>

  <!-- Comandos -->
  <section id="commands">
    <h2>Crear Comando Personalizado</h2>
    <input type="text" id="commandName" placeholder="Nombre del comando (e.g., /volar)">
    <select id="commandPermission">
      <option value="everyone">Todos</option>
      <option value="op">Solo OP</option>
      <option value="console">Solo consola</option>
    </select>

    <div class="subsection">
      <h3>Argumentos</h3>
      <textarea id="commandArgs" placeholder="Argumentos (e.g., <jugador> <efecto>)"></textarea>
      <h3>Acción del comando</h3>
      <textarea id="commandCode" placeholder="Código o acción (e.g., dar vuelo al jugador)"></textarea>
    </div>

    <div class="subsection">
      <h3>Evento al presionar tecla</h3>
      <label>Tecla para ejecutar (opcional)</label>
      <input type="text" id="commandKeyBind" placeholder="Tecla (e.g., V para volar)">
    </div>

    <button onclick="generateCommand()">Generar Comando</button>
    <textarea id="commandOutput" readonly></textarea>
  </section>

  <!-- Armaduras -->
  <section id="armor">
    <h2>Crear Armadura con Efectos</h2>
    <input type="text" id="armorName" placeholder="Nombre del set">
    <select id="armorType">
      <option value="helmet">Casco</option>
      <option value="chestplate">Pechera</option>
      <option value="leggings">Pantalones</option>
      <option value="boots">Botas</option>
    </select>
    <input type="file" id="armorTexture" accept="image/*">
    <img id="armorPreview" class="preview" src="" alt="Vista previa">

    <div class="subsection">
      <h3>Efectos por pieza</h3>
      <select id="armorEffectPiece">
        <option value="none">Ninguno</option>
        <option value="speed">Velocidad</option>
        <option value="strength">Fuerza</option>
        <option value="night_vision">Visión nocturna</option>
      </select>
      <input type="number" id="armorEffectLevelPiece" placeholder="Nivel" value="1">
    </div>

    <div class="subsection">
      <h3>Bonus por set completo</h3>
      <select id="armorEffectFull">
        <option value="none">Ninguno</option>
        <option value="flight">Vuelo</option>
        <option value="regeneration">Regeneración</option>
      </select>
      <input type="number" id="armorEffectLevelFull" placeholder="Nivel" value="1">
    </div>

    <div>
      <button onclick="generateArmor()">Generar Armadura</button>
      <button onclick="clearFile('armorTexture')">Eliminar Textura</button>
    </div>
    <textarea id="armorOutput" readonly></textarea>
  </section>

  <!-- Exportar -->
  <section id="export">
    <h2>Exportar Mod</h2>
    <label>Versión de Minecraft:</label>
    <select id="mcVersion">
      <option>1.20.1</option>
      <option>1.19.4</option>
      <option>1.18.2</option>
    </select>
    <label>Modloader:</label>
    <select id="modLoader">
      <option>Forge</option>
      <option>Fabric</option>
    </select>
    <button onclick="exportMod()">Exportar y Descargar Mod</button>
    <div class="warning">
      <strong>Importante en iPhone/iPad:</strong><br>
      Si no descarga automáticamente: Mantén presionado el enlace y elige "Descargar archivo vinculado" o "Guardar en Archivos".
    </div>
  </section>
</main>

<!-- JSZip -->
<script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>

<script>
// Pestañas
function showTab(tab){
  document.querySelectorAll('section').forEach(s=>s.classList.remove('active'));
  document.getElementById(tab).classList.add('active');
  document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
  event.currentTarget.classList.add('active');
}

// Previsualización y limpiar archivos
['blockTexture','itemTexture','mobModel','guiImage','armorTexture'].forEach(id=>{
  const input = document.getElementById(id);
  if(input){
    input.addEventListener('change', e=>{
      const file = e.target.files[0];
      if(file) document.getElementById(id+'Preview').src = URL.createObjectURL(file);
    });
  }
});
function clearFile(id){
  const input = document.getElementById(id);
  input.value = "";
  const preview = document.getElementById(id+'Preview');
  if(preview) preview.src = "";
}

// Generar elementos
function generateBlock(){
  const block = {type:"block",name:document.getElementById('blockName').value.trim(),color:document.getElementById('blockColor').value,hardness:parseFloat(document.getElementById('blockHardness').value),resistance:parseFloat(document.getElementById('blockResistance').value),texture:document.getElementById('blockTexture').files[0]?.name||""};
  document.getElementById('blockOutput').value = JSON.stringify(block,null,2);
}
function generateItem(){
  const item = {
    type:"item",
    name:document.getElementById('itemName').value.trim(),
    damage:parseInt(document.getElementById('itemDamage').value),
    stack:parseInt(document.getElementById('itemStack').value),
    texture:document.getElementById('itemTexture').files[0]?.name||"",
    projectile:document.getElementById('itemProjectile').value,
    projectileDamage:parseFloat(document.getElementById('itemProjectileDamage').value),
    keyBind:document.getElementById('itemKeyBind').value.trim(),
    keyEvent:document.getElementById('itemKeyEvent').value,
    keyCustom:document.getElementById('itemKeyCustom').value
  };
  document.getElementById('itemOutput').value = JSON.stringify(item,null,2);
}
function generateMob(){
  const mob = {
    type:"mob",
    name:document.getElementById('mobName').value.trim(),
    health:parseInt(document.getElementById('mobHealth').value),
    damage:parseInt(document.getElementById('mobDamage').value),
    speed:parseFloat(document.getElementById('mobSpeed').value),
    flying:document.getElementById('mobFlying').value,
    effect:document.getElementById('mobEffect').value,
    effectDuration:parseInt(document.getElementById('mobEffectDuration').value),
    model:document.getElementById('mobModel').files[0]?.name||""
  };
  document.getElementById('mobOutput').value = JSON.stringify(mob,null,2);
}
function generateGUI(){
  const gui = {
    type:"gui",
    name:document.getElementById('guiName').value.trim(),
    slots:parseInt(document.getElementById('guiSlots').value),
    guiType:document.getElementById('guiType').value,
    openEvent:document.getElementById('guiOpenEvent').value,
    clickEvent:document.getElementById('guiClickEvent').value,
    image:document.getElementById('guiImage').files[0]?.name||""
  };
  document.getElementById('guiOutput').value = JSON.stringify(gui,null,2);
}
function generateCommand(){
  const command = {
    type:"command",
    name:document.getElementById('commandName').value.trim(),
    permission:document.getElementById('commandPermission').value,
    args:document.getElementById('commandArgs').value,
    code:document.getElementById('commandCode').value,
    keyBind:document.getElementById('commandKeyBind').value.trim()
  };
  document.getElementById('commandOutput').value = JSON.stringify(command,null,2);
}
function generateArmor(){
  const armor = {
    type:"armor",
    name:document.getElementById('armorName').value.trim(),
    slot:document.getElementById('armorType').value,
    texture:document.getElementById('armorTexture').files[0]?.name||"",
    effectPiece:document.getElementById('armorEffectPiece').value,
    effectLevelPiece:parseInt(document.getElementById('armorEffectLevelPiece').value),
    effectFull:document.getElementById('armorEffectFull').value,
    effectLevelFull:parseInt(document.getElementById('armorEffectLevelFull').value)
  };
  document.getElementById('armorOutput').value = JSON.stringify(armor,null,2);
}

// Exportación
async function exportMod() {
  const zip = new JSZip();
  const sections = [
    ['blocks.json','blockOutput','blockTexture'],
    ['items.json','itemOutput','itemTexture'],
    ['mobs.json','mobOutput','mobModel'],
    ['gui.json','guiOutput','guiImage'],
    ['commands.json','commandOutput',''],
    ['armors.json','armorOutput','armorTexture']
  ];

  let anyFile=false;

  for(const [fileName, textareaId, fileInputId] of sections){
    const text = document.getElementById(textareaId).value.trim();
    if(text){
      zip.file(fileName,text);
      anyFile=true;
    }
    if(fileInputId){
      const f = document.getElementById(fileInputId).files[0];
      if(f) zip.file(f.name,f);
    }
  }

  if(!anyFile){
    alert("No hay archivos generados. Crea al menos un elemento.");
    return;
  }

  const metadata = {mcVersion: document.getElementById('mcVersion').value, modLoader: document.getElementById('modLoader').value};
  zip.file("metadata.json", JSON.stringify(metadata,null,2));

  const blob = await zip.generateAsync({type:"blob"});
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = "mcreator_lite_mod.zip";
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
}
</script>

</body>
</html>